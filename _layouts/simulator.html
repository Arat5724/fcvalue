---
layout: single
---
{{ content }}

<p>Beta 버전입니다.</p>
<p>※실제 선수팩과 결과가 다를 수 있습니다※</p>

<div id="card-display">
    <div class="thumb"></div>
    <div class="player_price"></div>
</div>
<div class="button_wrap">
    <button id="open-pack-button">1장 개봉</button>
</div>
<script>
    document.getElementById('open-pack-button').addEventListener('click', function() {

    var cardDisplay = document.getElementById('card-display');

    var players = [
    {% for player in page.players %}
    {
        name: "{{ player.name }}",
        id: "{{ player.id }}",
        season: "{{ player.season }}",
        upgrade: {{ player.upgrade }},
        value: "{{ player.value }}",
        prob: {{ player.prob }},
        position: "{{ player.position }}",
        ovr: {{ player.ovr }},
        pay: {{ player.pay }}
    },
    {% endfor %}
    ];

    const randomNum = Math.random();
    let cumulativeProbability = 0;
    for (let i = 0; i < players.length; i++) {
        cumulativeProbability += players[i].prob;
        if (randomNum <= cumulativeProbability) {
            var player = players[i];
            break;
        }
    }
    // Create new card element for each player
    var newCardElement = document.createElement('div');
    newCardElement.classList.add("card");

    setTimeout(function () {
        cardDisplay.innerHTML = "";

        var thumbDiv = document.createElement('div');
        thumbDiv.classList.add("thumb", player.season);

        // back
        var cardBackDiv = document.createElement('div');
        cardBackDiv.classList.add("card_back");
        var imgElement = document.createElement('img');
        imgElement.src =
            "https://ssl.nexon.com/s2/game/fc/online/obt/externalAssets/card/" + player.season + ".png";

        imgElement.alt="";

        cardBackDiv.appendChild(imgElement);
        thumbDiv.appendChild(cardBackDiv);

        // faceon
        var faceonDiv = document.createElement('div');
        faceonDiv.classList.add("img");

        var faceonElement = document.createElement('img');
        faceonElement.src =
            "https://fco.dn.nexoncdn.co.kr/live/externalAssets/common/playersActionHigh/p" + player.id +  ".png";
        faceonElement.onerror = function() {
            faceonElement.src = "https://fco.dn.nexoncdn.co.kr/live/externalAssets/common/playersHigh/p" + player.id.substring(3) +  ".png";
            faceonElement.onerror = function() {
                faceonElement.src = "https://fco.dn.nexoncdn.co.kr/live/externalAssets/common/players/not_found.png";
            }
        };
        faceonDiv.appendChild(faceonElement);
        thumbDiv.appendChild(faceonDiv);

        //ovr
        var ovrDiv = document.createElement('div');
        ovrDiv.classList.add("ovr");
        ovrDiv.innerHTML = player.ovr;
        thumbDiv.appendChild(ovrDiv);

        // position
        var positionDiv = document.createElement('div');
        positionDiv.classList.add("position");
        positionDiv.innerHTML = player.position;
        thumbDiv.appendChild(positionDiv);

        // season
        var seasonDiv = document.createElement('div');
        seasonDiv.classList.add("season");
        var imgElement = document.createElement('img');
        imgElement.src =
        "https://ssl.nexon.com/s2/game/fc/online/obt/externalAssets/season/" + player.season + "_big.png";
        seasonDiv.appendChild(imgElement);
        thumbDiv.appendChild(seasonDiv);

        // upgrade
        var selectorDiv = document.createElement('div');
        selectorDiv.classList.add("selector_wrap");
        selectorDiv.innerHTML = player.upgrade;

        if (8 <= player.upgrade) {
            selectorDiv.classList.add("upgrade_gold");
        } else if (5 <= player.upgrade) {
            selectorDiv.classList.add("upgrade_silver");
        } else if (2 <= player.upgrade) {
            selectorDiv.classList.add("upgrade_cooper");
        }
        thumbDiv.appendChild(selectorDiv);

        // name wrap
        var nameWrapDiv = document.createElement('div');
        nameWrapDiv.classList.add("name_wrap");
        var seasonDiv = document.createElement('div');
        seasonDiv.classList.add("season");
        var imgElement = document.createElement('img');
        imgElement.src =
        "https://ssl.nexon.com/s2/game/fc/online/obt/externalAssets/season/" + player.season + ".png";
        seasonDiv.appendChild(imgElement);
        nameWrapDiv.appendChild(seasonDiv);
        var nameDiv = document.createElement('div');
        nameDiv.classList.add("name");
        nameDiv.innerHTML = player.name;
        nameWrapDiv.appendChild(nameDiv);
        thumbDiv.appendChild(nameWrapDiv);

        // pay
        var payDiv = document.createElement('div');
        payDiv.classList.add("pay");
        payDiv.innerHTML = player.pay;
        thumbDiv.appendChild(payDiv);

        cardDisplay.appendChild(thumbDiv);

        // price
        var playerPriceDiv = document.createElement('div');
        playerPriceDiv.classList.add("player_price");
        playerPriceDiv.innerHTML = player.value;
        cardDisplay.appendChild(playerPriceDiv);

    }, 0); // wait for half second to start moving up

});
</script>
